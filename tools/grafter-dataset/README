Thank you for downloading our tool and dataset. 

** If you are the reviewer for our FSE paper, please use our tool to inspect and
examine the clones and their behavioral divergince. You can directly load clone
pairs in our dataset to the tool. It also has a nice UI and provides convenient
features such as program differencing, state-level comparison, and test-level 
comparison. We beliebe it will save you a lot of time. 



<<<<<<<<<<<<<<<<<< How to run Grafter >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Please follow the instructions below to run our tool.

1. Please download and unzip the zip file for each subject program first. A few 
   important folders are listed below.

   subject
   |___ clone_report
   |___ mutants
   |___ graft_log
   |___ src
   |___ clusters

   * clone_report has a xml file, ant_clones_with_tests.xml which contains the 
     clone and test information about the 17 pairs of code clones in the Apache
     Ant project. We use these 17 clone pairs to evaluate Grafter in our paper. 
     In the xml file, file paths to clones and tests are relative to the source
     and test folders of the Ant project. The source and test folders are also
     encoded in the Grafter config file and passed as configuration parameters 
     to Grafter. You can find the config file, Grafter.config in the dropbox. 
     For the ease of inspecting these clones, you can load them from the xml 
     file by clicking the "Load" button in our Grafter tool.

   * mutants contains the mutants that the mutation analysis framework, Major 
     generates on each pair of clones. For each clone, there is a mutation log 
     file, mutants.log that contains all information you may want to know about 
     each mutant, e.g., mutant type, line number of the mutation, etc.

   * graft_log has two files, mutation.log and mutation_Jiang.log. mutation.log
     contains the test and state comparison results logged in our evaluation.
     mutation_Jiang.log contains the mutation testing result logged when we use
     Jiang et al.'s approach to detect mutants.

   * The folder src contains the source code of the Apache Ant project.

   * The folder clusters contains the original clone report from Deckards. You 
     can also load the raw Deckard clone report to our tool by clicking the 
     "New" button. Please notice that we also create our xml-formatted clone 
     report from the raw Deckard report. You can find more elaboration in the
     following section. 

2. Download the config file, Grafter.config and update the configurations.
   Simply, you only need to change the prefix "/home/troy/SysAssure/dataset/
   apache-ant-1.9.6/" to the path where you extract the dataset to in Step 1.

3. Download our grafter tool, grafter.jar, and run it using following command.

   java -jar grafter.jar /path/to/your/config/file


<<<<<<<<<<<<<<<<<<<<<<<< How to load our dataset to the tool >>>>>>>>>>>>>>>>>

Please first download our dataset and config Grafter following the instructions
above if you have not done that. 

1. run Grafter.

   java -jar grafter.jar /path/to/your/config/file

2. Load the clone report in the apache-ant-1.9.6/clone_report/ folder by clicking
   the "Load" button. All clones and their tests are loaded to the explorer panel
   on the left side of the UI. 

Now you can inspect all 17 pairs of clones and their test cases we use in the 
evaluation. The clones are organized in a tree structure in th explorer panel.
The outer-most nodes are the clone group node. The children of each group node 
are the clones, which is formatted as XXX(A, B) where XXX is the containing method
of the clone, A is the line number where the clone region starts, and B is the
line number where the clone region ends. The children of each clone node are the
tests that exercise the clone.


<<<<<<<<<<<<<<<<<<<<<<<< Important Features >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Please notice you should try all these features after loading the clone report.

* Textual Differencing : Right click on the group node of clones you want to 
compare, select "Compare". The textual difference between the clone regions will 
be displayed in the side-by-side diff view on the right panel of the UI.

* Test-level Behavioral Comparison : Right click on the group node of clones 
you want to compare at the test level, select "Compare Test Behavior". Grafter
will pop up a window that shows the comparison result on each test. Do not worry
if the result is not popped out immediately. Because Grafter will instrument, 
graft, execute clones at the back end and so it may take some time, depending 
on the number of tests. But it should not take more than 2 minutes.

* State-level Behavioral Comparison : Right click on the group node of clones 
you want to compare at the state level, select "Compare State Behavior". Grafter
will pop up a window that shows the comparison result on each state. Again, do 
not worry if the result is not popped out immediately. The state-level comparison
usually take longer time because Grafter needs to serialize the intermediate 
program states to the file system, involving a lot of IO.

* Clone Transplantation : Given a pair of clones, you can view the graft result
after transplanting one clone to the location of another. The graft result refers
to the adapted target location (or java file) that contains the grafted clone. 
To do it, you need to first compare the pair of clones you want to graft using 
the Textual Differencing feature. Then you can choose to graft the clone from 
the file from left to right in the side-by-side view or the other way round by 
clicking the "GraftLeft" or the "GraftRight" button.

* Test Coverage Inference : Another important feature is to infer the test cases
that exercise each clone. It is important because we personally reply this 
feature to find test cases for the clones reported by Deckard when creating 
the benchmark. To do it, after loading either the initial Deckard report or our
xml-formatted report, click the "Coverage" button in the menu bar on the top.
 

<<<<<<<<<<<<<<<<<<<<<<<<  Contact >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Grafter is implemented and maintained by Tianyi Zhang. Please contact him via 
email (tianyi.zhang@cs.ucla.edu) if you have any questions.
